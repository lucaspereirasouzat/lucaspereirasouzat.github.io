const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/Utils.CTQyNz6H.js","_astro/sparkTitle.DCU_Odjx.js","_astro/cn.Bh4i3_zX.js","_astro/index.NEDEFKed.js","_astro/motion.DhRAmCJf.js","_astro/index.BX0mCmLm.js"])))=>i.map(i=>d[i]);
import{c as p,_ as f}from"./sparkTitle.DCU_Odjx.js";import"./cn.Bh4i3_zX.js";import"./index.NEDEFKed.js";import"./motion.DhRAmCJf.js";const u=2,_=1,w=12,I=1;class A{constructor(t){this.loadImageShape=async e=>{if(!this._engine.loadImage)throw new Error(`${p} image shape not initialized`);await this._engine.loadImage({gif:e.gif,name:e.name,replaceColor:e.replaceColor??!1,src:e.src})},this._engine=t}addImage(t){this._engine.images||(this._engine.images=[]),this._engine.images.push(t)}async draw(t){const{context:e,radius:s,particle:a,opacity:r}=t,i=a.image,g=i?.element;if(i){if(e.globalAlpha=r,i.gif&&i.gifData){const{drawGif:o}=await f(async()=>{const{drawGif:n}=await import("./Utils.CTQyNz6H.js");return{drawGif:n}},__vite__mapDeps([0,1,2,3,4]));o(t)}else if(g){const o=i.ratio,n={x:-s,y:-s},l=s*u;e.drawImage(g,n.x,n.y,l,l/o)}e.globalAlpha=_}}getSidesCount(){return w}async init(t){const e=t.actualOptions;if(!(!e.preload||!this._engine.loadImage))for(const s of e.preload)await this._engine.loadImage(s)}async loadShape(t){if(t.shape!=="image"&&t.shape!=="images")return;this._engine.images||(this._engine.images=[]);const e=t.shapeData;if(!e)return;this._engine.images.find(a=>a.name===e.name||a.source===e.src)||(await this.loadImageShape(e),await this.loadShape(t))}async particleInit(t,e){if(e.shape!=="image"&&e.shape!=="images")return;this._engine.images||(this._engine.images=[]);const s=this._engine.images,a=e.shapeData;if(!a)return;const r=e.getFillColor(),i=s.find(m=>m.name===a.name||m.source===a.src);if(!i)return;const g=a.replaceColor??i.replaceColor;if(i.loading){setTimeout(()=>{this.particleInit(t,e)});return}let o;if(i.svgData&&r){const{replaceImageColor:m}=await f(async()=>{const{replaceImageColor:c}=await import("./index.BX0mCmLm.js").then(d=>d.U);return{replaceImageColor:c}},__vite__mapDeps([5,1,2,3,4]));o=await m(i,a,r,e)}else o={color:r,data:i,element:i.element,gif:i.gif,gifData:i.gifData,gifLoopCount:i.gifLoopCount,loaded:!0,ratio:a.width&&a.height?a.width/a.height:i.ratio??I,replaceColor:g,source:a.src};o.ratio||(o.ratio=1);const n=a.fill??e.shapeFill,l=a.close??e.shapeClose,h={image:o,fill:n,close:l};e.image=h.image,e.shapeFill=h.fill,e.shapeClose=h.close}}export{A as ImageDrawer};
